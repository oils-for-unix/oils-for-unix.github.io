  <!DOCTYPE html>
  <html>
    <head>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>OSH versus Oil</title>
      <link rel="stylesheet" type="text/css" href="../web/base.css" />
    </head>
    <body class="width40">

<p>Here is a short guide:</p>
<ul>
<li><code>bin/osh</code> runs the <a href="https://www.oilshell.org/cross-ref.html#osh-language">OSH language</a>, which is extremely <strong>compatible</strong> with POSIX shell and bash.  It's designed to run existing scripts.</li>
<li><code>bin/oil</code> runs the <a href="https://www.oilshell.org/cross-ref.html#oil-language">Oil language</a>, a <strong>new</strong> shell language that's designed to be familiar to Python and JavaScript users.  You can <strong>gracefully upgrade</strong> your shell scripts to it, or write brand new scripts in it.
<ul>
<li>See <a href="https://www.oilshell.org/release/latest/doc/oil-language-tour.html">A Tour of the Oil Language</a></li>
</ul>
</li>
</ul>
<p>But they actually run in the same binary and use the same parser and interpreter!  <code>bin/osh</code> and <code>bin/oil</code> are <strong>symlinks</strong> (or one line &quot;forwarding&quot; scripts).</p>
<p>This means that underneath there isn't a sharp line between OSH and Oil.  (The fuzzy line has also changed as the project has matured.)</p>
<p>Specifically, there are many global shell options like <code>shopt --set parse_brace</code> that change OSH into Oil.  Running <code>bin/oil</code> is equivalent to running <code>bin/osh</code> with the <strong>option group</strong> <code>shopt --set oil:all</code>.  See the full option list below.</p>
<p>(As of 12/2021, OSH is a lot more <strong>mature</strong> than Oil.)</p>
<h2>Examples</h2>
<p>For examples of the syntax, see <a href="https://www.oilshell.org/blog/2020/01/simplest-explanation.html">The Simplest Explanation of Oil</a>.</p>
<h2>What's the Difference between <code>strict:all</code>, <code>oil:upgrade</code>, and <code>oil:all</code> ?</h2>
<ul>
<li>
<p><code>strict:all</code>. Use this if you want to run the same script under <strong>multiple shells</strong>, like bash and OSH.</p>
</li>
<li>
<p><code>oil:upgrade</code>. Use this if you're <strong>upgrading</strong> existing script, and dropping compatibility with other shells.</p>
<ul>
<li>You can use new Oil features, but you won't have to worry about every last <code>strict_</code> bug.</li>
<li>You can start writing <code>if (x &gt; 0) { echo 'positive' }</code> without worrying about unrelated breakage.</li>
</ul>
</li>
<li>
<p><code>oil:all</code>. Use this for a brand <strong>new</strong> program.</p>
<ul>
<li>This is equivalent to running bin/oil rather than bin/osh.</li>
</ul>
</li>
<li>
<p>Blog: <a href="https://www.oilshell.org/blog/2021/12/backlog-language.html#what-shell-options-should-i-use-for-a-new-script">What Options Should I Use For a New Script?</a></p>
</li>
<li>
<p>Docs: <a href="https://www.oilshell.org/release/latest/doc/options.html">Global Shell Options</a></p>
</li>
</ul>
<h2>What are the use cases for OSH and Oil?</h2>
<p>Here's another way of phrasing the same info above.</p>
<ol>
<li>Run <strong>old</strong> scripts as is (no options)</li>
<li><strong>Improve</strong> old scripts while keeping compatibility with <code>sh</code> or <code>bash</code> (<code>strict:all</code>)</li>
<li>Start <strong>upgrading</strong> old scripts, dropping compatibility (<code>oil:upgrade</code>)</li>
<li>Write <strong>new</strong> scripts (<code>oil:all</code> or <code>bin/oil</code>)</li>
</ol>
<h2>More Detail</h2>
<ul>
<li><a href="https://github.com/NixOS/rfcs/pull/99#issuecomment-962495958">https://github.com/NixOS/rfcs/pull/99#issuecomment-962495958</a>
<ul>
<li>Four Features That Justify a New Unix Shell (OSH features)</li>
<li>Five Essential Features of the Oil Language (not done yet)</li>
</ul>
</li>
</ul>
<h2>Full Option List in <code>oil:all</code></h2>
<p>This command lets you see the difference between OSH and Oil in detail!  <code>-s</code> means that the option is <strong>set</strong> when running in Oil mode, and <code>-u</code> means that it's <strong>unset</strong>.</p>
<pre><code>$ oil -c 'shopt -p oil:all'
shopt -s command_sub_errexit
shopt -u dashglob
shopt -s errexit
shopt -u expand_aliases
shopt -s inherit_errexit
shopt -s nounset
shopt -s nullglob
shopt -s parse_amp
shopt -s parse_at
shopt -s parse_at_all
shopt -u parse_backslash
shopt -u parse_backticks
shopt -s parse_brace
shopt -u parse_dollar
shopt -s parse_equals
shopt -u parse_ignored
shopt -s parse_paren
shopt -s parse_raw_string
shopt -s parse_triple_quote
shopt -s pipefail
shopt -s process_sub_fail
shopt -u redefine_proc
shopt -s sigpipe_status_ok
shopt -s simple_echo
shopt -s simple_eval_builtin
shopt -s simple_test_builtin
shopt -s simple_word_eval
shopt -s strict_argv
shopt -s strict_arith
shopt -s strict_array
shopt -s strict_control_flow
shopt -s strict_errexit
shopt -s strict_glob
shopt -s strict_nameref
shopt -s strict_tilde
shopt -s strict_word_eval
shopt -u xtrace_details
shopt -s xtrace_rich
</code></pre>
<h2>Related</h2>
<p><a href="Gradually-Upgrading-Shell-to-Oil.html">Gradually Upgrading Shell to Oil</a></p>
  </body>
</html>

